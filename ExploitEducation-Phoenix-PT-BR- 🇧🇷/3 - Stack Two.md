Index
1. [ðŸŽ¯ Objetivo](https://github.com/0xturazzi/Writeups/blob/master/ExploitEducation-Phoenix-PT-BR-%20%F0%9F%87%A7%F0%9F%87%B7/2%20-%20Stack%20Two.md#-objetivo)
3. [ðŸ’« ExplicaÃ§Ã£o](https://github.com/0xturazzi/Writeups/blob/master/ExploitEducation-Phoenix-PT-BR-%20%F0%9F%87%A7%F0%9F%87%B7/2%20-%20Stack%20Two.md#-explicaÃ§Ã£o)
4. [ðŸ”¥ SoluÃ§Ã£o](https://github.com/0xturazzi/Writeups/blob/master/ExploitEducation-Phoenix-PT-BR-%20%F0%9F%87%A7%F0%9F%87%B7/2%20-%20Stack%20Two.md#-soluÃ§Ã£o)

# ðŸŽ¯ Objetivo
Similar Ã  anterior, a gente precisa mudar o valor da variavel changeme,
mas dessa vez ao inves de usar o input ou agrv, vamos usar env!

# ðŸ’« ExplicaÃ§Ã£o
Nesse desafio, o programa usa getenv("ExploitEducation") para ler uma
enviroment variable. 
### ðŸŒ³ Environment Variable (VariÃ¡vel do ambiente)
Essas variaveis sÃ£o acessiveis para todos os programas
executando naquela seÃ§Ã£o. E normalmente contem preferencias como cores, o tipo de terminal, etcetc....

> VocÃª pode checa-las usando: $ env

> VocÃª pode definir uma atÃ© o resto da seÃ§Ã£o: $ export Nome=Valor

> VocÃª pode definir uma somente para execuÃ§Ã£o daquele programa: $ Nome=Valor ./stack-two

Para nÃ³s, nÃ£o faz tanta diferenÃ§a. O unico problema Ã© que nÃ£o podemos usar o Null Byte (0x00), pois ele Ã© usado para indicar o final de uma string ASCII, portanto terminando nossa variavel precocemente.

Em seguida, o valor Ã© copiado para um buffer[64] usando: strcpy(buffer, ptr). Com ptr sendo o valor da env 'ExploitEducation'.

A funÃ§Ã£o strcpy, assim como gets, nÃ£o checa se o valor Ã© maior que o buffer, tornando o programa vulnerÃ¡vel... :(

Por ultimo, o programa checa se changeme == 0x0d0a090a.
> Levando em consideraÃ§Ã£o que o sistema Ã© LE: 0a 09 0a 0d

Mas pera ai, checando o manual ASCII, esses caracteres sÃ£o usados para encerrar linha, nÃ£o Ã© uma letra do teclado! D:

Pois Ã©, entÃ£o vamos precisar usar os bytes diretamente. Esse Ã© um dos casos que o python3 reclama e o python2 funciona!

```
Se vocÃª quer tentar resolver sozinhe, agora Ã© a sua hora!

.
.
.
.
.
.
.
.
.
.
.
.
.

user@phoenix-amd64:/opt/phoenix/amd64$ ExploitEducation=$(python -c "print b'A'*64 + b'\x0a\x09\x0a\x0d'") ./stack-two 
Welcome to phoenix/stack-two, brought to you by https://exploit.education
Well done, you have successfully set changeme to the correct value
```

Uhuuu, esse foi mais fÃ¡cil :D

# ðŸ”¥ SoluÃ§Ã£o
> $ ExploitEducation=$(python -c "print b'A'*64 + b'\x0a\x09\x0a\x0d'") ./stack-two
